# EXGCD(扩展欧几里得算法)

前置知识gcd: $\gcd(a, b) = \gcd(b, a \% b)$

```cpp
ll gcd(ll a, ll b)
{
    return b ? gcd(b, a % b) : a;
}
```



## 求解 $a * x + b * y = \gcd(a, b)$(a, b为常数)的方程的一组整数解

## derivation

$b = 0$ 时 ，显然方程的解为 $x = 1, y = 0$

$b != 0$ 时由于 $\gcd(a, b) = \gcd(b, a \% b)$，显然另 $a = b, b = a \% b$ 即 $b * x + a \% b * y = \gcd(b, a \% b)$ 与原方程同解，并且$a * x + b * y = b * x + a \% b * y$。

设 $b * x + a \% b * y = \gcd(b, a \% b)$ 的解为 $x = x_0, y = y_0$ 

那么 $a * x + b * y = b * x_0 + a \% b * y_0$ 

​		$a * x + b * y = b * x_0 + (a - \lfloor \frac{a}{b} \rfloor * b) * y_0$

​		$a * x + b * y = b * x_0 + a * y_0 - \lfloor \frac{a}{b} \rfloor * b * y_0$

​		$a * x + b * y = a * y_0 + b * (x_0 - \lfloor \frac{a}{b} \rfloor * y_0)$

解得$x = y_0, y = x_0 - \lfloor \frac{a}{b} \rfloor * y_0$

## code

-   easy

    ```cpp
    void exgcd(ll a, ll b, ll &x, ll &y)
    {
        if (!b) // b = 0 的情况
        {
            x = 1, y = 0;
            return;
        }
        ll x0, y0;
        exgcd(b, a % b, x0, y0); // 求解 x0 和 y0
        x = y0, y = x0 - a / b * y0;
    }
    ```

-   brief

    ```cpp
    void exgcd(ll a, ll b, ll &x, ll &y)
    {
    	if (!b)
        {
            x = 1, y = 0;
            return;
        }
        exgcd(b, a % b, y, x);
        y -= a / b * x;
    }
    ```
    
-   succinct
    ```cpp
    void exgcd(ll a, ll b, ll &x, ll &y)
    {
        b ? exgcd(b, a % b, y, x), y -= a / b * x : x = 1, y = 0;
    }
    ```
